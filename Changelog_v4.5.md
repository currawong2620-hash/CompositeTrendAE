# Composite Trend EA v4.5 ‚Äì Adaptive Optimization (final)
**Release date:** 2025-11-05  
**Branch:** `v4.5-final`  
**Core build:** TFContext v7.2 + Forecast v2 (Œº/œÉ redesign)

---

## üß† Core Architecture
| Module | Changes |
|---------|----------|
| **TFContext_v2.mqh ‚Üí v7.2 Adaptive Smooth** | ‚Ä¢ –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω —Ä–∞—Å—á—ë—Ç `trendScore`.<br>‚Ä¢ –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è `(price‚ÄìMA)/ATR` –∏ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ ATR.<br>‚Ä¢ RSI —Ç–µ–ø–µ—Ä—å –¥–∞—ë—Ç –ø–ª–∞–≤–Ω—ã–π –≤–∫–ª–∞–¥ `(-1..+1)`.<br>‚Ä¢ ADX —É—Å–∏–ª–∏–≤–∞–µ—Ç —Å–∏–ª—É —Ç—Ä–µ–Ω–¥–∞ –ø—Ä–∏ >20.<br>‚Ä¢ `trendScore` —Ç–µ–ø–µ—Ä—å –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π (‚âà‚Äì1..+1), —á—Ç–æ –æ–∂–∏–≤–∏–ª–æ œÉ –∏ sens.<br>‚Ä¢ –ü–æ–≤–µ–¥–µ–Ω–∏–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ –≤ —Ç–µ—Å—Ç–µ—Ä–µ –∏ –Ω–∞ –∏—Å—Ç–æ—Ä–∏–∏. |
| **Forecast_v2.mqh ‚Üí Adaptive Optimization redesign** | ‚Ä¢ –†–∞—Å—á—ë—Ç Œº –∏ œÉ —Ç–µ–ø–µ—Ä—å –ø–æ **—Å–∞–º–æ–º—É bias**, –∞ –Ω–µ –ø–æ |bias|.<br>‚Ä¢ –î–æ–±–∞–≤–ª–µ–Ω–æ EMA-—Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ bias –∏ –æ—Ç–¥–µ–ª—å–Ω–æ–µ EMA –¥–ª—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (sens).<br>‚Ä¢ –ü–æ—Ä–æ–≥–∏ `weak/strong` —Å—Ç—Ä–æ—è—Ç—Å—è –ø–æ `|Œº| ¬± kœÉ`, sens –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ œÉ/Œº.<br>‚Ä¢ –£–±—Ä–∞–Ω—ã —Å—Ç—É–ø–µ–Ω—å–∫–∏ bias, —Å–∏–≥–º–∞ —Å—Ç–∞–ª–∞ ¬´–∂–∏–≤–æ–π¬ª.<br>‚Ä¢ –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ `[Forecast]` —Å Œº, œÉ, sens, thr, regime. |
| **Stats.mqh** | ‚Ä¢ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ EMA-–º–µ—Ç—Ä–∏–∫ (PF, WinRate, BiasStability).<br>‚Ä¢ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –Ω–æ–≤—ã–º Forecast.<br>‚Ä¢ –î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ `Stats_Update()` –∏ `Stats_DebugString()`. |
| **Logging.mqh** | ‚Ä¢ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –≤—ã–≤–æ–¥ `[LOG]`, `[TRADE]`, `[ADAPT]`, `[SIM]`.<br>‚Ä¢ –£–±—Ä–∞–Ω—ã –Ω–µ–¥–µ–∫–ª–∞—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏.<br>‚Ä¢ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –ª–æ–≥-—Ñ–∞–π–ª–æ–º –∏ –∫–æ–Ω—Å–æ–ª—å—é. |
| **Enums.mqh, Config.mqh** | ‚Ä¢ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–ø–∏—Å–∞–Ω–∏–π –∏ –∑–Ω–∞—á–µ–Ω–∏–π —Ä–µ–∂–∏–º–æ–≤.<br>‚Ä¢ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ sens –∏ bias. |

---

## ‚öôÔ∏è Trade Subsystem
| Module | Changes |
|---------|----------|
| **Trade_Manager.mqh** | ‚Ä¢ –ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ SL/TP –∏–∑ `ModeAnalyzer2`.<br>‚Ä¢ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ `perfState` (‚ÄúPoor‚Äù ‚Üí –ø–∞—É–∑–∞).<br>‚Ä¢ –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ `[ADAPT]` –∏ `[TRADE]`.<br>‚Ä¢ –ì–æ—Ç–æ–≤ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π. |
| **Trade_Simulator.mqh** | ‚Ä¢ –°–æ–≤–º–µ—Å—Ç–∏–º —Å Forecast v2 (bias, Œº, œÉ).<br>‚Ä¢ –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –ª–æ–≥.<br>‚Ä¢ –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ fallback –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–æ–º —Ä—ã–Ω–∫–µ. |

---

## üñ• Panels
| Module | Changes |
|---------|----------|
| **Panel_Forecast_v2.mqh** | ‚Ä¢ –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω –ø–æ–¥ Œº¬±œÉ –º–æ–¥–µ–ª—å.<br>‚Ä¢ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ sens –∏ thr-bias.<br>‚Ä¢ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ä–µ–∂–∏–º (Trend / Range / Neutral). |
| **Panel_Main.mqh** | ‚Ä¢ –û–±–Ω–æ–≤–ª—ë–Ω —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∫–æ–Ω—Å–æ–ª–∏.<br>‚Ä¢ –°–æ–≤–º–µ—Å—Ç–∏–º —Å –Ω–æ–≤–æ–π Forecast –∏ Stats.<br>‚Ä¢ –£—Å—Ç—Ä–∞–Ω—ë–Ω –∫–æ–Ω—Ñ–ª–∏–∫—Ç –≤—ã–≤–æ–¥–∞ –º–µ–∂–¥—É –ø–∞–Ω–µ–ª—è–º–∏. |

---

## üß© Integration
- –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª `CompositeTrendAdaptive.mq5` –ø–µ—Ä–µ–ø–∏—Å–∞–Ω –ø–æ–¥ ‚Äúdelayed init + retry logic‚Äù.
- –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ç–µ—Å—Ç–µ—Ä–æ–º (—É—á—Ç—ë–Ω `MQL_TESTER`).
- –°–∏–º—É–ª—è—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–æ–º —Ä—ã–Ω–∫–µ, –Ω–µ –º–µ—à–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–º —Å–¥–µ–ª–∫–∞–º.
- –ö–æ–º–ø–∏–ª—è—Ü–∏—è –±–µ–∑ –æ—à–∏–±–æ–∫, —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤.
- –£–ª—É—á—à–µ–Ω–∞ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å Forecast –∫ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—é –¥–∞–Ω–Ω—ã—Ö (reinit on fail).

---

## üßæ Summary
| Component | Version | Status |
|------------|----------|---------|
| Core | v4.5 Adaptive Optimization | ‚úÖ Stable |
| TFContext | v7.2 Adaptive Smooth | ‚úÖ Stable |
| Panels | v2 Forecast + Main Sync | ‚úÖ Stable |
| Trade | v4.5 Adaptive | ‚úÖ Stable |
| Docs | Changelog_v4.5.md | ‚úÖ Added |

---

üìà **Result:**  
œÉ –∏ sens —Ç–µ–ø–µ—Ä—å ¬´–∂–∏–≤—ã–µ¬ª –∏ —É—Å—Ç–æ–π—á–∏–≤—ã–µ;  
—Ä–µ–∂–∏–º—ã —Ä—ã–Ω–∫–∞ –¥–∏–Ω–∞–º–∏—á–Ω–æ –º–µ–Ω—è—é—Ç—Å—è;  
–ø–∞–Ω–µ–ª—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç—Ä–∞–∂–∞–µ—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è;  
–≤—Å—ë –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ–ª–Ω–æ–º –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ.
